

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Extracting researchers based on affiliations and publications history &mdash; API Lab - reusable notebooks for research data analytics - powered by Dimensions Analytics API</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/js/custom.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Identification of reviewers for funders: Globally and among Panels" href="funders-reviewers-identification-globally-and-among-panels.html" />
    <link rel="prev" title="Expert Identification with the Dimensions API - An Introduction" href="Experts-search-introduction.html" />
    

   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-149959808-1"></script>
   <!-- <script src="_static/js/custom.js"></script> -->


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DSL
          

          
            
            <img src="../_static/dimensions-logo@2x.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          

   <p class="">
      <h3 id="cookbooks_title">API COOKBOOKS</h3>
   </p>


   
            
            
              
            
            
              <p class="caption"><span class="caption-text">Folder</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html">Calculating the H-index of a researcher</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html#Background">Background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html#Prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html#Selecting-a-researcher">Selecting a researcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html#The-H-Index-function">The H-Index function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html#Getting-citations-data-from-Dimensions">Getting citations data from Dimensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html#Wrapping-things-up">Wrapping things up</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Calculating-the-H-Index-of-a-researcher.html#Where-to-find-out-more">Where to find out more</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Experts-search-introduction.html">Expert Identification with the Dimensions API - An Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Experts-search-introduction.html#Prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experts-search-introduction.html#At-a-glance">At a glance</a></li>
<li class="toctree-l2"><a class="reference internal" href="Experts-search-introduction.html#Step-1:-Concept-Extraction">Step 1: Concept Extraction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#What-are-concepts?">What are concepts?</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Extracting-concepts-with-the-DSL">Extracting concepts with the DSL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Experts-search-introduction.html#Step-2:-Expert-Identification">Step 2: Expert Identification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Example-1.-Basic-query-using-concepts">Example 1. Basic query using <code class="docutils literal notranslate"><span class="pre">concepts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Example-2.-Query-with-OR-connectors">Example 2. Query with <code class="docutils literal notranslate"><span class="pre">OR</span></code> connectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Example-3.-Query-with-where-filters">Example 3. Query with <code class="docutils literal notranslate"><span class="pre">where</span></code> filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Example-4.-Adding-Overlap-Annotations-(eg-for-conflict-of-interests-checks)">Example 4. Adding Overlap Annotations (eg for conflict of interests checks)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Example-5.-Query-with-MUST/NOT-Operators">Example 5. Query with MUST/NOT Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Example-6.-MUST-together-with-AND/OR">Example 6. MUST together with AND/OR</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Example-7.-Wildcard-searches">Example 7. Wildcard searches</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Experts-search-introduction.html#Additional-resources:-shortcut-functions-included-in-Dimcli">Additional resources: shortcut functions included in Dimcli</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#extract_concepts">extract_concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#identify_experts">identify_experts</a></li>
<li class="toctree-l3"><a class="reference internal" href="Experts-search-introduction.html#Build-a-reviewers-matrix">Build a reviewers matrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Extracting researchers based on affiliations and publications history</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Prerequisites">Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Select-an-organization-ID">Select an organization ID</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Background:-understanding-the-data-model">Background: understanding the data model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Methodology:-two-options-available">Methodology: two options available</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Approach-1.-From-publications-to-researchers">Approach 1. From publications to researchers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Approach-2.-From-researchers-to-publications">Approach 2. From researchers to publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Conclusions">Conclusions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html">Identification of reviewers for funders: Globally and among Panels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#Introduction:-Use-Cases-For-Reviewer-Identification">Introduction: Use Cases For Reviewer Identification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#Kinds-of-identification">Kinds of identification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#Prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#1.-Loading-and-preprocessing-text-data">1. Loading and preprocessing text data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#1.1-Loading-from-File-(placeholder-code)">1.1 Loading from File (placeholder code)</a></li>
<li class="toctree-l3"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#1.2-Loading-Sample-Data">1.2 Loading Sample Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#1.3-Preprocess-data-and-extract-concepts">1.3 Preprocess data and extract concepts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#2.-The-Two-Use-Cases---Recap">2. The Two Use Cases - Recap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#2.1-Global-identification-use-case">2.1 Global identification use case</a></li>
<li class="toctree-l3"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#2.2-Panel-identification-use-case">2.2 Panel identification use case</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#3.-Global-identification">3. Global identification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#3.1-Advanced-Cases:-Working-around-the-limitations-of-global-search">3.1 Advanced Cases: Working around the limitations of global search</a><ul>
<li class="toctree-l4"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#3.1.1-Searching-based-on-organizational-affiliation">3.1.1 Searching based on organizational affiliation</a></li>
<li class="toctree-l4"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#3.1.2-Searching-based-on-previous-funding-history">3.1.2 Searching based on previous funding history</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#4.-Panel-Identification">4. Panel Identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="funders-reviewers-identification-globally-and-among-panels.html#Conclusions">Conclusions</a></li>
</ul>
</li>
</ul>

            
          


   <div id="sidebar_github" style="margin-top: 12px;">
   <h3>Github Source</h3>

      <div style="margin: 10px 20px;">
      
         <iframe src="https://ghbtns.com/github-btn.html?user=digital-science&repo=dimensions-api-lab&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>

         <iframe src="https://ghbtns.com/github-btn.html?user=digital-science&repo=dimensions-api-lab&type=fork&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe> 
      
      </div>

   </div>


        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DSL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    

    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<script src='https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js'></script>
<script>require=requirejs;</script><a class="reference external image-reference" href="https://colab.research.google.com/github/digital-science/dimensions-api-lab/blob/master/cookbooks/Researchers-Search-tips-V2.ipynb"><img alt="../_images/badge-colab.svg" src="../_images/badge-colab.svg" /></a>
<a class="reference external image-reference" href="https://github.com/digital-science/dimensions-api-lab/blob/master/cookbooks/Researchers-Search-tips-V2.ipynb"><img alt="../_images/badge-github-custom.svg" src="../_images/badge-github-custom.svg" /></a>
<hr class="docutils" />
<div class="section" id="Extracting-researchers-based-on-affiliations-and-publications-history">
<h1>Extracting researchers based on affiliations and publications history<a class="headerlink" href="#Extracting-researchers-based-on-affiliations-and-publications-history" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this notebook is to demonstrate how to extract <a class="reference external" href="https://docs.dimensions.ai/dsl/language.html#searching-for-researchers">researchers data</a> using the Dimensions API.</p>
<p>Specifically, we want to find out about all researchers based on these two criteria:</p>
<ol class="arabic simple">
<li><p><strong>Affiliation</strong>. That is, whether they are / have been affiliated to a specific <strong>GRID</strong> organization</p></li>
<li><p><strong>Publications</strong>. Whether they have published within a chosen <strong>time frame</strong>.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==</span><span class="se">\n</span><span class="s2">CHANGELOG</span><span class="se">\n</span><span class="s2">This notebook was last run on </span><span class="si">%s</span><span class="se">\n</span><span class="s2">==&quot;</span> <span class="o">%</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1">, %Y&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==
CHANGELOG
This notebook was last run on Jan 25, 2022
==
</pre></div></div>
</div>
<div class="section" id="Prerequisites">
<h2>Prerequisites<a class="headerlink" href="#Prerequisites" title="Permalink to this headline">¶</a></h2>
<p>This notebook assumes you have installed the <a class="reference external" href="https://pypi.org/project/dimcli/">Dimcli</a> library and are familiar with the <a class="reference external" href="https://api-lab.dimensions.ai/cookbooks/1-getting-started/1-Using-the-Dimcli-library-to-query-the-API.html">‘Getting Started’ tutorial</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install dimcli -U --quiet

<span class="kn">import</span> <span class="nn">dimcli</span>
<span class="kn">from</span> <span class="nn">dimcli.utils</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==</span><span class="se">\n</span><span class="s2">Logging in..&quot;</span><span class="p">)</span>
<span class="c1"># https://digital-science.github.io/dimcli/getting-started.html#authentication</span>
<span class="n">ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;https://app.dimensions.ai&quot;</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
  <span class="kn">import</span> <span class="nn">getpass</span>
  <span class="n">KEY</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="s1">&#39;API Key: &#39;</span><span class="p">)</span>
  <span class="n">dimcli</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">ENDPOINT</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">KEY</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  <span class="n">dimcli</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">ENDPOINT</span><span class="p">)</span>
<span class="n">dsl</span> <span class="o">=</span> <span class="n">dimcli</span><span class="o">.</span><span class="n">Dsl</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Searching config file credentials for &#39;https://app.dimensions.ai&#39; endpoint..
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
==
Logging in..
Dimcli - Dimensions API Client (v0.9.6)
Connected to: &lt;https://app.dimensions.ai/api/dsl&gt; - DSL v2.0
Method: dsl.ini file
</pre></div></div>
</div>
<div class="section" id="Select-an-organization-ID">
<h3>Select an organization ID<a class="headerlink" href="#Select-an-organization-ID" title="Permalink to this headline">¶</a></h3>
<p>For the purpose of this exercise, we will are going to use <a class="reference external" href="https://grid.ac/institutes/grid.258806.1">grid.258806.1</a> and the time frame <strong>2013-2018</strong>. Feel free though to change the parameters below as you want, eg by <a class="reference external" href="https://grid.ac/institutes">choosing another GRID organization</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample org: grid.258806.1</span>
<span class="n">GRIDID</span> <span class="o">=</span> <span class="s2">&quot;grid.258806.1&quot;</span> <span class="c1">#@param {type:&quot;string&quot;}</span>
<span class="n">START_YEAR</span> <span class="o">=</span> <span class="mi">2013</span> <span class="c1">#@param {type:&quot;slider&quot;, min:1900, max:2020, step: 1}</span>
<span class="n">END_YEAR</span> <span class="o">=</span> <span class="mi">2018</span> <span class="c1">#@param {type:&quot;slider&quot;, min:1900, max:2020, step: 1}</span>

<span class="k">if</span> <span class="n">START_YEAR</span> <span class="o">&lt;</span> <span class="n">END_YEAR</span><span class="p">:</span> <span class="n">START_YEAR</span> <span class="o">=</span> <span class="n">END_YEAR</span>
<span class="n">YEARS</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">START_YEAR</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">END_YEAR</span><span class="si">}</span><span class="s2">]&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Background:-understanding-the-data-model">
<h2>Background: understanding the data model<a class="headerlink" href="#Background:-understanding-the-data-model" title="Permalink to this headline">¶</a></h2>
<p>In order to process researchers affiliation data in the context of publications, we should first take the time to understand how this data is structured in Dimensions.</p>
<p>The JSON results of any query with shape <code class="docutils literal notranslate"><span class="pre">search</span> <span class="pre">publications</span> <span class="pre">where</span> <span class="pre">....</span> <span class="pre">return</span> <span class="pre">publications</span></code> are composed by a list of publications. If we open up one single publication record we will immediately see that authors are stored in a nested object <code class="docutils literal notranslate"><span class="pre">authors</span></code> that contains a list of dictionaries. Each element in this dictionary represents <strong>one single publication author</strong> and includes other information e.g. name, surname, ID, the organizations he/she is affiliated with etc..</p>
<p>For example, in order to extract the second author of the tenth publication from our results we would do the following: <code class="docutils literal notranslate"><span class="pre">results.publications[10]['authors'][1]</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># author info
...
    {&#39;first_name&#39;: &#39;Noboru&#39;,
     &#39;last_name&#39;: &#39;Sebe&#39;,
     &#39;orcid&#39;: &#39;&#39;,
     &#39;current_organization_id&#39;: &#39;grid.258806.1&#39;,
     &#39;researcher_id&#39;: &#39;ur.010647607673.28&#39;,
     &#39;affiliations&#39;: [{&#39;id&#39;: &#39;grid.258806.1&#39;,
       &#39;name&#39;: &#39;Kyushu Institute of Technology&#39;,
       &#39;city&#39;: &#39;Kitakyushu&#39;,
       &#39;city_id&#39;: 1859307,
       &#39;country&#39;: &#39;Japan&#39;,
       &#39;country_code&#39;: &#39;JP&#39;,
       &#39;state&#39;: None,
       &#39;state_code&#39;: None}]}
 ...
</pre></div>
</div>
<p>Here’s a object model diagram summing up how data is structured.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span> <span class="s2">&quot;http://api-sample-data.dimensions.ai/diagrams/data_model_researchers_publications1.v2.jpg&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<img src="http://api-sample-data.dimensions.ai/diagrams/data_model_researchers_publications1.v2.jpg" width="800"/></div>
</div>
<p>There are a few important things to keep in mind:</p>
<ul class="simple">
<li><p><strong>Publication Authors VS Researchers</strong>. In Dimensions, publication authors don’t necessarily have a <code class="docutils literal notranslate"><span class="pre">researcher</span></code> ID (eg because they haven’t been disambiguated yet). So a publication may have N authors (stored in JSON within the <code class="docutils literal notranslate"><span class="pre">authors</span></code> key), but only a subset of these include a <code class="docutils literal notranslate"><span class="pre">researcher_id</span></code> link. PS see also the searching for researchers section of the <a class="reference external" href="https://docs.dimensions.ai/dsl/language.html#searching-for-researchers">API docs</a> for more info on this topic.</p></li>
<li><p><strong>Time of the affiliation</strong>. Researchers can be affiliated to a specific GRID organization either <em>at the time of speaking</em> (now), <strong>or</strong> <em>at the time of writing</em> (i.e. when the article was published). The DSL uses different properties to express this fact: <code class="docutils literal notranslate"><span class="pre">current_research_org</span></code> or simply <code class="docutils literal notranslate"><span class="pre">research_orgs</span></code>.</p></li>
<li><p><strong>Denormalized fields</strong>. Both the <a class="reference external" href="https://docs.dimensions.ai/dsl/data-sources.html#publications">Publication</a> and <a class="reference external" href="https://docs.dimensions.ai/dsl/data-sources.html#researchers">Researcher</a> sources include a <code class="docutils literal notranslate"><span class="pre">research_orgs</span></code> field. In both cases that’s a <em>denormalized</em> field ie a ‘shortcut version’ of data primarily found in the <code class="docutils literal notranslate"><span class="pre">authors</span></code> field of publications. However, although they share the same name, the two <code class="docutils literal notranslate"><span class="pre">research_orgs</span></code> fields don’t have the same meaning.</p>
<ul>
<li><p>In publications, <code class="docutils literal notranslate"><span class="pre">research_orgs</span></code> contains the set of all authors’ affiliations for a single article.</p></li>
<li><p>In researchers, <code class="docutils literal notranslate"><span class="pre">research_orgs</span></code> contains the set of all research organizations a single individual has been affiliated to throughout his/her career (as far as Dimensions knows, of course!).</p></li>
</ul>
</li>
</ul>
<p>So, in the real world we often have scenarios like the following one:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span> <span class="s2">&quot;http://api-sample-data.dimensions.ai/diagrams/data_model_researchers_publications2.v2.jpg&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<img src="http://api-sample-data.dimensions.ai/diagrams/data_model_researchers_publications2.v2.jpg" width="1000"/></div>
</div>
</div>
<div class="section" id="Methodology:-two-options-available">
<h2>Methodology: two options available<a class="headerlink" href="#Methodology:-two-options-available" title="Permalink to this headline">¶</a></h2>
<p>It turns out that there are two possible ways to extract these data, depending on whether we start our queries from Publications or from Researchers.</p>
<ol class="arabic simple">
<li><p><strong>Starting from the Publication source</strong>, we can first filter publications based on our constraints (eg year range <code class="docutils literal notranslate"><span class="pre">[2013-2018]</span></code> and <code class="docutils literal notranslate"><span class="pre">research_orgs=&quot;grid.258806.1&quot;</span></code> - but it could be any other query parameters); second, we would loop over all of these publications so to extract all relevant reasearchers using the <code class="docutils literal notranslate"><span class="pre">affiliation</span></code> data.</p></li>
<li><p><strong>Starting from the Researcher source</strong>, we would first filter researchers based on our constraints (eg with <code class="docutils literal notranslate"><span class="pre">research_orgs=&quot;grid.258806.1&quot;</span></code>); second, we would search for publications linked to these researchers, which have been published in the time frame <code class="docutils literal notranslate"><span class="pre">[2013-2018]</span></code>; lastly, we extract all relevant reasearchers using the <code class="docutils literal notranslate"><span class="pre">affiliation</span></code> data.</p></li>
</ol>
<p>As we will find out later, both approaches are perfectly valid and return the same results.</p>
<p>The first apporach is generally quicker as it has only two steps (while the second one has three).</p>
<p>In real-world situations though, deciding which approach is best depends on the specific query filters being used and on the impact these filters have on the overall performance/speed of the data extraction. There is no fixed rule and a bit of trial &amp; error can go a long way in helping you optimize your data extraction algorithm!</p>
</div>
<div class="section" id="Approach-1.-From-publications-to-researchers">
<h2>Approach 1. From publications to researchers<a class="headerlink" href="#Approach-1.-From-publications-to-researchers" title="Permalink to this headline">¶</a></h2>
<p>Starting from the <em>publications</em> source, the steps are as follows:</p>
<ol class="arabic simple">
<li><p>Filtering publications for year range [2013-2018] and research_orgs=“grid.258806.1”</p>
<ul class="simple">
<li><p>i.e. <code class="docutils literal notranslate"><span class="pre">search</span> <span class="pre">publications</span> <span class="pre">where</span> <span class="pre">year</span> <span class="pre">in</span> <span class="pre">[2013:2018]</span> <span class="pre">and</span> <span class="pre">research_orgs=&quot;grid.258806.1&quot;</span> <span class="pre">return</span> <span class="pre">publications</span></code></p></li>
</ul>
</li>
<li><p>Looping over publications’ authors and extracting relevant researchers</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">['affiliation']['id']</span> <span class="pre">==</span> <span class="pre">&quot;grid.258806.1&quot;</span></code></p>
<ul>
<li><p>=&gt; <strong>that gives us the affiliations at the time of publishing</strong></p></li>
</ul>
</li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">['current_organization_id']</span> <span class="pre">==</span> <span class="pre">&quot;grid.258806.1&quot;</span></code></p>
<ul>
<li><p>=&gt; <strong>that gives us the affiliations at the time of speaking</strong></p></li>
</ul>
</li>
</ul>
</li>
</ol>
<p>First off, we can to get all publications based on our search criteria by using a <code class="docutils literal notranslate"><span class="pre">loop</span></code> query.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pubs</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">query_iterative</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;search publications</span>
<span class="s2">                                where year in </span><span class="si">{</span><span class="n">YEARS</span><span class="si">}</span><span class="s2"> and research_orgs=&quot;</span><span class="si">{</span><span class="n">GRIDID</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">                            return publications[id+title+doi+year+type+authors+journal+issue+volume]&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Starting iteration with limit=1000 skip=0 ...
0-1000 / 1052 (1.94s)
1000-1052 / 1052 (1.28s)
===
Records extracted: 1052
</pre></div></div>
</div>
<p>First we want to know how many researchers linked to these publications were affiliated to the GRID organization <em>when the publication was created</em> (note: they may be at at a different institution right now).</p>
<p>The affiliation data in publications represent exactly that: we can thus loop over them (for each publication/researcher) and keep only the ones matching our GRID ID.</p>
<p><strong>TIP</strong> affiliations can be extracted easily thanks one of the ‘dataframe’ transformation methods in <a class="reference external" href="https://github.com/digital-science/dimcli">Dimcli</a>: <code class="docutils literal notranslate"><span class="pre">as_dataframe_authors_affiliations</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract affiliations from a publications list</span>
<span class="n">affiliations</span> <span class="o">=</span> <span class="n">pubs</span><span class="o">.</span><span class="n">as_dataframe_authors_affiliations</span><span class="p">()</span>
<span class="c1"># select only affiliations for GRIDID</span>
<span class="n">authors_historical</span> <span class="o">=</span> <span class="n">affiliations</span><span class="p">[</span><span class="n">affiliations</span><span class="p">[</span><span class="s1">&#39;aff_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">GRIDID</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># remove duplicates by eliminating publication-specific data</span>
<span class="n">authors_historical</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pub_id&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">authors_historical</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;researcher_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;===</span><span class="se">\n</span><span class="s2">Researchers with affiliation to </span><span class="si">{</span><span class="n">GRIDID</span><span class="si">}</span><span class="s2"> at time of writing:&quot;</span><span class="p">,</span> <span class="n">authors_historical</span><span class="o">.</span><span class="n">researcher_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===&quot;</span><span class="p">)</span>
<span class="c1"># preview the data</span>
<span class="n">authors_historical</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
===
Researchers with affiliation to grid.258806.1 at time of writing: 830
===
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aff_city</th>
      <th>aff_city_id</th>
      <th>aff_country</th>
      <th>aff_country_code</th>
      <th>aff_id</th>
      <th>aff_name</th>
      <th>aff_raw_affiliation</th>
      <th>aff_state</th>
      <th>aff_state_code</th>
      <th>researcher_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Department of Electrical and Electronic Engine...</td>
      <td></td>
      <td></td>
      <td></td>
      <td>Meng</td>
      <td>Ge</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Department of Control Engineering, Kyushu Inst...</td>
      <td></td>
      <td></td>
      <td>ur.0724144151.56</td>
      <td>Joo Kooi</td>
      <td>Tan</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Department of Electrical Engineering, Kyushu I...</td>
      <td></td>
      <td></td>
      <td>ur.010214262704.60</td>
      <td>Gaber</td>
      <td>Magdy</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Department of Electrical Engineering, Kyushu I...</td>
      <td></td>
      <td></td>
      <td>ur.011456332771.53</td>
      <td>Yasunori</td>
      <td>Mitani</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Kyushu Institute of Technology, Kitakyushu, 80...</td>
      <td></td>
      <td></td>
      <td>ur.013152454441.15</td>
      <td>Kazuhiro</td>
      <td>Toyoda</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5278</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>九州工業大学</td>
      <td></td>
      <td></td>
      <td>ur.013230043761.21</td>
      <td>幸左</td>
      <td>賢二</td>
    </tr>
    <tr>
      <th>5283</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Kyushu Institute of Technology</td>
      <td></td>
      <td></td>
      <td>ur.015230506045.34</td>
      <td>Hirohisa</td>
      <td>ISOGAI</td>
    </tr>
    <tr>
      <th>5290</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Kyushu Institute of Technology, Japan</td>
      <td></td>
      <td></td>
      <td>ur.012270025364.95</td>
      <td>Naoya</td>
      <td>Higuchi</td>
    </tr>
    <tr>
      <th>5291</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Kyushu Institute of Technology, Japan</td>
      <td></td>
      <td></td>
      <td>ur.013003725541.53</td>
      <td>Yasunobu</td>
      <td>Imamura</td>
    </tr>
    <tr>
      <th>5294</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Kyushu Institute of Technology, Japan</td>
      <td></td>
      <td></td>
      <td>ur.015310517641.55</td>
      <td>Takeshi</td>
      <td>Shinohara</td>
    </tr>
  </tbody>
</table>
<p>830 rows × 12 columns</p>
</div></div>
</div>
<p>Note: * The first ‘publication-affiliations’ dataframe we get may contain duplicate records - eg if an author has more than one publication it’ll be listed twice. That’s why we have an extra step where we drop the <code class="docutils literal notranslate"><span class="pre">pub_id</span></code> column and simply count unique researchers, based on their researcher ID.</p>
<p>This can be achieved simply by taking into consideration a different field, called <code class="docutils literal notranslate"><span class="pre">current_organization_id</span></code>, available at the outer level of the JSON author structure (see the data model section above) - outside the <code class="docutils literal notranslate"><span class="pre">affiliations</span></code> list.</p>
<p>Luckily Dimcli includes another handy method for umpacking authors into a dataframe: <code class="docutils literal notranslate"><span class="pre">as_dataframe_authors</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">authors_current</span> <span class="o">=</span> <span class="n">pubs</span><span class="o">.</span><span class="n">as_dataframe_authors</span><span class="p">()</span>
<span class="n">authors_current</span> <span class="o">=</span> <span class="n">authors_current</span><span class="p">[</span><span class="n">authors_current</span><span class="p">[</span><span class="s1">&#39;current_organization_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">GRIDID</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">authors_current</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pub_id&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">authors_current</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;researcher_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;===</span><span class="se">\n</span><span class="s2">Researchers with affiliation to </span><span class="si">{</span><span class="n">GRIDID</span><span class="si">}</span><span class="s2"> at the time of speaking:&quot;</span><span class="p">,</span> <span class="n">authors_current</span><span class="o">.</span><span class="n">researcher_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===&quot;</span><span class="p">)</span>
<span class="n">authors_current</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
===
Researchers with affiliation to grid.258806.1 at the time of speaking: 584
===
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>affiliations</th>
      <th>corresponding</th>
      <th>current_organization_id</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>orcid</th>
      <th>raw_affiliation</th>
      <th>researcher_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Joo Kooi</td>
      <td>Tan</td>
      <td>None</td>
      <td>[Department of Control Engineering, Kyushu Ins...</td>
      <td>ur.0724144151.56</td>
    </tr>
    <tr>
      <th>9</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Yasunori</td>
      <td>Mitani</td>
      <td>None</td>
      <td>[Department of Electrical Engineering, Kyushu ...</td>
      <td>ur.011456332771.53</td>
    </tr>
    <tr>
      <th>12</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Kazuhiro</td>
      <td>Toyoda</td>
      <td>None</td>
      <td>[Kyushu Institute of Technology, Kitakyushu, 8...</td>
      <td>ur.013152454441.15</td>
    </tr>
    <tr>
      <th>13</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Mengu</td>
      <td>Cho</td>
      <td>None</td>
      <td>[Kyushu Institute of Technology, Kitakyushu, 8...</td>
      <td>ur.013152112405.28</td>
    </tr>
    <tr>
      <th>14</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Siowhwa</td>
      <td>Teo</td>
      <td>[0000-0001-9927-8309]</td>
      <td>[Graduate School of Life Science and Systems E...</td>
      <td>ur.010525770330.49</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4763</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>古川</td>
      <td>徹生</td>
      <td>None</td>
      <td>[九州工業大学大学院生命体工学研究科]</td>
      <td>ur.013546017565.95</td>
    </tr>
    <tr>
      <th>4770</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>西田</td>
      <td>治男</td>
      <td>None</td>
      <td>[九州工業大学大学院生命体工学研究科]</td>
      <td>ur.07662175025.31</td>
    </tr>
    <tr>
      <th>4784</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Naoya</td>
      <td>Higuchi</td>
      <td>None</td>
      <td>[Kyushu Institute of Technology, Japan]</td>
      <td>ur.012270025364.95</td>
    </tr>
    <tr>
      <th>4785</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Yasunobu</td>
      <td>Imamura</td>
      <td>None</td>
      <td>[Kyushu Institute of Technology, Japan]</td>
      <td>ur.013003725541.53</td>
    </tr>
    <tr>
      <th>4788</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Takeshi</td>
      <td>Shinohara</td>
      <td>None</td>
      <td>[Kyushu Institute of Technology, Japan]</td>
      <td>ur.015310517641.55</td>
    </tr>
  </tbody>
</table>
<p>584 rows × 8 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Approach-2.-From-researchers-to-publications">
<h2>Approach 2. From researchers to publications<a class="headerlink" href="#Approach-2.-From-researchers-to-publications" title="Permalink to this headline">¶</a></h2>
<p>Using this approach, we start our search from the ‘researchers’ database (instead of the ‘publications’ database).</p>
<p>There are 3 main steps:</p>
<ol class="arabic simple">
<li><p>Filtering researchers with research_orgs=GRID-ID (note: this gives us affiliated researches <em>at any point in time</em>)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">search</span> <span class="pre">researchers</span> <span class="pre">where</span> <span class="pre">research_orgs=&quot;grid.258806.1&quot;</span> <span class="pre">return</span> <span class="pre">researchers</span></code></p></li>
</ul>
</li>
<li><p>Searching for publications linked to these researchers and linked to GRID-ID, which have been published in the time frame <code class="docutils literal notranslate"><span class="pre">[2013-2018]</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">search</span> <span class="pre">publications</span> <span class="pre">where</span> <span class="pre">researchers.id</span> <span class="pre">in</span> <span class="pre">{LIST</span> <span class="pre">OF</span> <span class="pre">IDS}</span> <span class="pre">and</span> <span class="pre">year</span> <span class="pre">in</span> <span class="pre">[2013:2018]</span> <span class="pre">and</span> <span class="pre">research_orgs=&quot;grid.258806.1&quot;</span> <span class="pre">return</span> <span class="pre">publications</span></code></p></li>
<li><p>NOTE: this a variation of the Approach-1 query above: we have just added the researchers IDs filter (thus reducing the search space)</p></li>
</ul>
</li>
<li><p>Extracting relevant researchers from publications, using the same exact steps as in approach 1 above.</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">['current_organization_id']</span> <span class="pre">==</span> <span class="pre">&quot;grid.258806.1&quot;</span></code></p>
<ul>
<li><p>=&gt; <strong>that gives us the affiliations at the time of speaking</strong></p></li>
</ul>
</li>
<li><p>or if <code class="docutils literal notranslate"><span class="pre">['affiliation']['id']</span> <span class="pre">==</span> <span class="pre">&quot;grid.258806.1&quot;</span></code></p>
<ul>
<li><p>=&gt; <strong>that gives us the affiliations at the time of publishing</strong></p></li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;search researchers where research_orgs=&quot;</span><span class="si">{</span><span class="n">GRIDID</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s2">        return researchers[basics]&quot;&quot;&quot;</span>
<span class="n">researchers_json</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">query_iterative</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">researchers</span> <span class="o">=</span> <span class="n">researchers_json</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>
<span class="n">researchers</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Starting iteration with limit=1000 skip=0 ...
0-1000 / 11838 (5.43s)
1000-2000 / 11838 (3.73s)
2000-3000 / 11838 (2.46s)
3000-4000 / 11838 (1.84s)
4000-5000 / 11838 (3.44s)
5000-6000 / 11838 (2.64s)
6000-7000 / 11838 (2.29s)
7000-8000 / 11838 (1.98s)
8000-9000 / 11838 (2.25s)
9000-10000 / 11838 (2.40s)
10000-11000 / 11838 (3.11s)
11000-11838 / 11838 (3.06s)
===
Records extracted: 11838
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_name</th>
      <th>id</th>
      <th>last_name</th>
      <th>research_orgs</th>
      <th>orcid_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Makoto</td>
      <td>ur.07777767140.16</td>
      <td>Kobayashi</td>
      <td>[{'acronym': 'KIT', 'city_name': 'Kitakyushu',...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ashraful M</td>
      <td>ur.07777460411.31</td>
      <td>Hoque</td>
      <td>[{'city_name': 'Houston', 'country_name': 'Uni...</td>
      <td>[0000-0002-3970-8538]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Fujio</td>
      <td>ur.07777374057.66</td>
      <td>Kubo</td>
      <td>[{'city_name': 'Hiroshima', 'country_name': 'J...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Muhammad Akmal Kamarudin</td>
      <td>ur.07777204200.43</td>
      <td>Kamarudin</td>
      <td>[{'acronym': 'UM', 'city_name': 'Kuala Lumpur'...</td>
      <td>[0000-0002-2256-5948]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Chinatsu</td>
      <td>ur.0777713743.09</td>
      <td>Ikeura</td>
      <td>[{'acronym': 'KIT', 'city_name': 'Kitakyushu',...</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now we need to select only the researchers who have <strong>published in the time frame [2013:2018]</strong>. So for each researcher ID we must extract the full publication history in order to verify their relevance.</p>
<p>The most efficient way to do this is to use a query that <strong>extracts the publication history for several researchers at the same time</strong> (so to avoid overruning our API quota), then, as a second step, producing a clean list of relevant researchers from it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">researchers_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">researchers</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
<span class="c1"># no of researchers IDs per query: so to ensure we never hit the 1000 records limit per query</span>
<span class="n">CHUNKS_SIZE</span> <span class="o">=</span> <span class="mi">300</span>

<span class="n">q</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;search publications</span>
<span class="s2">                where researchers.id in </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">                and year in </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">                and research_orgs=&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
<span class="s2">            return publications[id+title+doi+year+type+authors+journal+issue+volume] limit 1000&quot;&quot;&quot;</span>


<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks_of</span><span class="p">(</span><span class="n">researchers_ids</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">CHUNKS_SIZE</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">dsl</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">chunk</span><span class="p">),</span> <span class="n">YEARS</span><span class="p">,</span> <span class="n">GRIDID</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">publications</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---</span><span class="se">\n</span><span class="s2">Found&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="s2">&quot;publications for the given criteria (including duplicates)&quot;</span><span class="p">)</span>

<span class="c1"># simulate a DSL payload using Dimcli</span>
<span class="n">pubs_v2</span> <span class="o">=</span> <span class="n">dimcli</span><span class="o">.</span><span class="n">DslDataset</span><span class="o">.</span><span class="n">from_publications_list</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># transform to a dataframe to remove duplicates quickly</span>
<span class="n">pubs_v2_df</span> <span class="o">=</span> <span class="n">pubs_v2</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>
<span class="n">pubs_v2_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final result:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pubs_v2_df</span><span class="p">),</span> <span class="s2">&quot;unique publications&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Returned Publications: 59 (total = 59)
Time: 1.99s
Returned Publications: 49 (total = 49)
Time: 0.93s
Returned Publications: 48 (total = 48)
Time: 0.93s
Returned Publications: 61 (total = 61)
Time: 1.02s
Returned Publications: 36 (total = 36)
Time: 0.86s
Returned Publications: 41 (total = 41)
Time: 0.85s
Returned Publications: 64 (total = 64)
Time: 0.94s
Returned Publications: 36 (total = 36)
Time: 0.91s
Returned Publications: 29 (total = 29)
Time: 0.98s
Returned Publications: 48 (total = 48)
Time: 0.93s
Returned Publications: 40 (total = 40)
Time: 0.90s
Returned Publications: 23 (total = 23)
Time: 0.79s
Returned Publications: 45 (total = 45)
Time: 0.93s
Returned Publications: 53 (total = 53)
Time: 1.13s
Returned Publications: 38 (total = 38)
Time: 0.94s
Returned Publications: 61 (total = 61)
Time: 0.96s
Returned Publications: 36 (total = 36)
Time: 1.76s
Returned Publications: 59 (total = 59)
Time: 1.06s
Returned Publications: 52 (total = 52)
Time: 0.94s
Returned Publications: 47 (total = 47)
Time: 0.96s
Returned Publications: 25 (total = 25)
Time: 0.88s
Returned Publications: 52 (total = 52)
Time: 0.98s
Returned Publications: 67 (total = 67)
Time: 0.98s
Returned Publications: 72 (total = 72)
Time: 1.02s
Returned Publications: 26 (total = 26)
Time: 0.83s
Returned Publications: 64 (total = 64)
Time: 0.95s
Returned Publications: 52 (total = 52)
Time: 0.96s
Returned Publications: 42 (total = 42)
Time: 0.85s
Returned Publications: 75 (total = 75)
Time: 0.94s
Returned Publications: 81 (total = 81)
Time: 1.01s
Returned Publications: 99 (total = 99)
Time: 1.06s
Returned Publications: 22 (total = 22)
Time: 0.91s
Returned Publications: 109 (total = 109)
Time: 0.94s
Returned Publications: 48 (total = 48)
Time: 0.91s
Returned Publications: 38 (total = 38)
Time: 0.85s
Returned Publications: 78 (total = 78)
Time: 0.92s
Returned Publications: 53 (total = 53)
Time: 0.89s
Returned Publications: 72 (total = 72)
Time: 1.03s
Returned Publications: 50 (total = 50)
Time: 1.06s
Returned Publications: 15 (total = 15)
Time: 0.69s
---
Found 2065 publications for the given criteria (including duplicates)
Final result: 904 unique publications
</pre></div></div>
</div>
<p>This step is basically the same as in approach 1 above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract affiliations from a publications list</span>
<span class="n">affiliations_v2</span> <span class="o">=</span> <span class="n">pubs_v2</span><span class="o">.</span><span class="n">as_dataframe_authors_affiliations</span><span class="p">()</span>
<span class="c1"># select only affiliations for GRIDID</span>
<span class="n">authors_historical_v2</span> <span class="o">=</span> <span class="n">affiliations_v2</span><span class="p">[</span><span class="n">affiliations_v2</span><span class="p">[</span><span class="s1">&#39;aff_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">GRIDID</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># remove duplicates by eliminating publication-specific data</span>
<span class="n">authors_historical_v2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pub_id&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">authors_historical_v2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;researcher_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;===</span><span class="se">\n</span><span class="s2">Researchers with affiliation to </span><span class="si">{</span><span class="n">GRIDID</span><span class="si">}</span><span class="s2"> at time of writing:&quot;</span><span class="p">,</span> <span class="n">authors_historical_v2</span><span class="o">.</span><span class="n">researcher_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===&quot;</span><span class="p">)</span>
<span class="c1"># preview the data</span>
<span class="n">authors_historical_v2</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
===
Researchers with affiliation to grid.258806.1 at time of writing: 740
===
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aff_city</th>
      <th>aff_city_id</th>
      <th>aff_country</th>
      <th>aff_country_code</th>
      <th>aff_id</th>
      <th>aff_name</th>
      <th>aff_raw_affiliation</th>
      <th>aff_state</th>
      <th>aff_state_code</th>
      <th>researcher_id</th>
      <th>first_name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Graduate School of Life Science and Systems En...</td>
      <td></td>
      <td></td>
      <td>ur.010525770330.49</td>
      <td>Siowhwa</td>
      <td>Teo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Graduate School of Life Science and Systems En...</td>
      <td></td>
      <td></td>
      <td>ur.07706074430.00</td>
      <td>Zhanglin</td>
      <td>Guo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Graduate School of Life Science and Systems En...</td>
      <td></td>
      <td></td>
      <td>ur.012076416030.50</td>
      <td>Zhenhua</td>
      <td>Xu</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Graduate School of Life Science and Systems En...</td>
      <td></td>
      <td></td>
      <td>ur.010227671107.36</td>
      <td>Chu</td>
      <td>Zhang</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Graduate School of Life Science and Systems En...</td>
      <td></td>
      <td></td>
      <td>ur.014730512667.72</td>
      <td>Yusuke</td>
      <td>Kamata</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12176</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>九州工業大学</td>
      <td></td>
      <td></td>
      <td>ur.012307631725.34</td>
      <td>熊本</td>
      <td>拓哉</td>
    </tr>
    <tr>
      <th>12202</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Department of Bioscience and Bioinformatics, K...</td>
      <td></td>
      <td></td>
      <td>ur.010340773642.58</td>
      <td>Satoshi</td>
      <td>Fujii</td>
    </tr>
    <tr>
      <th>12706</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>九州工業大学大学院情報工学研究院</td>
      <td></td>
      <td></td>
      <td>ur.010035501405.12</td>
      <td>國近</td>
      <td>秀信</td>
    </tr>
    <tr>
      <th>12728</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>Graduate School of Life Science and Systems En...</td>
      <td></td>
      <td></td>
      <td>ur.01004062131.45</td>
      <td>Momoko</td>
      <td>Kumemura</td>
    </tr>
    <tr>
      <th>12752</th>
      <td>Kitakyushu</td>
      <td>1859307.0</td>
      <td>Japan</td>
      <td>JP</td>
      <td>grid.258806.1</td>
      <td>Kyushu Institute of Technology</td>
      <td>九工大</td>
      <td></td>
      <td></td>
      <td>ur.010024355257.03</td>
      <td>河野</td>
      <td>晴彦</td>
    </tr>
  </tbody>
</table>
<p>740 rows × 12 columns</p>
</div></div>
</div>
<p>Also here, the procedure is exactly the same as in approach 1.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">authors_current_v2</span> <span class="o">=</span> <span class="n">pubs_v2</span><span class="o">.</span><span class="n">as_dataframe_authors</span><span class="p">()</span>
<span class="n">authors_current_v2</span> <span class="o">=</span> <span class="n">authors_current_v2</span><span class="p">[</span><span class="n">authors_current_v2</span><span class="p">[</span><span class="s1">&#39;current_organization_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">GRIDID</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">authors_current_v2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pub_id&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">authors_current_v2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;researcher_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;===</span><span class="se">\n</span><span class="s2">Researchers with affiliation to </span><span class="si">{</span><span class="n">GRIDID</span><span class="si">}</span><span class="s2"> at the time of speaking:&quot;</span><span class="p">,</span> <span class="n">authors_current_v2</span><span class="o">.</span><span class="n">researcher_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===&quot;</span><span class="p">)</span>
<span class="n">authors_current_v2</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
===
Researchers with affiliation to grid.258806.1 at the time of speaking: 584
===
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>affiliations</th>
      <th>corresponding</th>
      <th>current_organization_id</th>
      <th>first_name</th>
      <th>last_name</th>
      <th>orcid</th>
      <th>raw_affiliation</th>
      <th>researcher_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Siowhwa</td>
      <td>Teo</td>
      <td>[0000-0001-9927-8309]</td>
      <td>[Graduate School of Life Science and Systems E...</td>
      <td>ur.010525770330.49</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Zhenhua</td>
      <td>Xu</td>
      <td>None</td>
      <td>[Graduate School of Life Science and Systems E...</td>
      <td>ur.012076416030.50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Chu</td>
      <td>Zhang</td>
      <td>None</td>
      <td>[Graduate School of Life Science and Systems E...</td>
      <td>ur.010227671107.36</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Yusuke</td>
      <td>Kamata</td>
      <td>None</td>
      <td>[Graduate School of Life Science and Systems E...</td>
      <td>ur.014730512667.72</td>
    </tr>
    <tr>
      <th>6</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Tingli</td>
      <td>Ma</td>
      <td>[0000-0002-3310-459X]</td>
      <td>[Graduate School of Life Science and Systems E...</td>
      <td>ur.01144540527.52</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10482</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>毛利</td>
      <td>恵美子</td>
      <td>None</td>
      <td>[九州工業大学大学院]</td>
      <td>ur.010435415335.62</td>
    </tr>
    <tr>
      <th>10525</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>田中</td>
      <td>和博</td>
      <td>None</td>
      <td>[九工大]</td>
      <td>ur.010456027505.69</td>
    </tr>
    <tr>
      <th>11311</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>國近</td>
      <td>秀信</td>
      <td>None</td>
      <td>[九州工業大学大学院情報工学研究院]</td>
      <td>ur.010035501405.12</td>
    </tr>
    <tr>
      <th>11328</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>Momoko</td>
      <td>Kumemura</td>
      <td>None</td>
      <td>[Graduate School of Life Science and Systems E...</td>
      <td>ur.01004062131.45</td>
    </tr>
    <tr>
      <th>11344</th>
      <td>[{'city': 'Kitakyushu', 'city_id': 1859307, 'c...</td>
      <td></td>
      <td>grid.258806.1</td>
      <td>河野</td>
      <td>晴彦</td>
      <td>None</td>
      <td>[九工大]</td>
      <td>ur.010024355257.03</td>
    </tr>
  </tbody>
</table>
<p>584 rows × 8 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Conclusions">
<h2>Conclusions<a class="headerlink" href="#Conclusions" title="Permalink to this headline">¶</a></h2>
<p>As anticipated above, <strong>both approaches are equally valid</strong> and in fact they return the same (or very similar) number of results. Let’s compare them:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create summary table</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">authors_current</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">authors_historical</span><span class="p">),</span>
         <span class="sd">&quot;&quot;&quot;search publications where year in [2013:2018] and research_orgs=&quot;grid.258806.1&quot; return publication&quot;&quot;&quot;</span><span class="p">,</span>
         <span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">authors_current_v2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">authors_historical_v2</span><span class="p">),</span>
         <span class="sd">&quot;&quot;&quot;search researchers where research_orgs=&quot;grid.258806.1&quot; return researchers --- then --- search publications where researchers.id in {IDS} and year in [2013:2018] and research_orgs={GRIDID} return publications&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="p">]]</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Method&#39;</span><span class="p">,</span> <span class="s1">&#39;Authors (current)&#39;</span><span class="p">,</span> <span class="s1">&#39;Authors (historical)&#39;</span><span class="p">,</span>  <span class="s1">&#39;Query&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Method</th>
      <th>Authors (current)</th>
      <th>Authors (historical)</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>584</td>
      <td>830</td>
      <td>search publications where year in [2013:2018] ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>584</td>
      <td>740</td>
      <td>search researchers where research_orgs="grid.2...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In some cases you might encounter small differences in the total number of records returned by the two approaches (eg one method returns 1-2 extra records than the other one).</p>
<p>This is usually due to a synchronization delay between Dimensions databases (e.g. publications and researchers). The differences are negligible in most cases, but in general it’s enough to run same extraction again after a day or two for the problem to disappear.</p>
<p>It depends on which/how many filters are being used in order to identify a suitable results set for your research question.</p>
<ul class="simple">
<li><p>The first approach is generally quicker as it has only two steps, as opposed to the second method that has three.</p></li>
<li><p>However if your initial <code class="docutils literal notranslate"><span class="pre">publications</span></code> query returns lots of results (eg for a large institution or big time frame), it may be quicker to try out method 2 instead.</p></li>
<li><p>The second approach can be handy if one wants to pre-filter researchers using one of the <a class="reference external" href="https://docs.dimensions.ai/dsl/data-sources.html#researchers">ther available properties</a> (e.g. <code class="docutils literal notranslate"><span class="pre">last_grant_year</span></code>)</p></li>
</ul>
<p>So, in general, deciding which approach is best depends on the specific query filters being used and on the impact these filters have on the overall performance/speed of the data extraction.</p>
<p>There is no fixed rule and a bit of trial &amp; error can go a long way in helping you optimize your data extraction algorithm!</p>
</div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference external" href="https://www.dimensions.ai/dimensions-apis/">Dimensions Analytics API</a> allows to carry out sophisticated research data analytics tasks like the ones described on this website. Check out also the associated <a class="reference external" href="https://github.com/digital-science/dimensions-api-lab">Github repository</a> for examples, the source code of these tutorials and much more.</p>
</div>
<a class="reference external image-reference" href="https://www.dimensions.ai/dimensions-apis/"><img alt="../_images/badge-dimensions-api.svg" src="../_images/badge-dimensions-api.svg" /></a>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    <p>© Copyright 2020 Digital Science & Research Solutions, Inc. All Rights Reserved | <a href="https://www.dimensions.ai/">About us</a> · <a href="https://www.dimensions.ai/privacy/">Privacy policy</a> · <a href="https://www.dimensions.ai/website-terms/">Legal terms</a></p>
     

    <!-- OneTrust Cookies Settings button start -->
    <button id="ot-sdk-btn" class="ot-sdk-show-settings">Cookie Settings</button>
    <!-- OneTrust Cookies Settings button end -->



</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
    

    <!-- Adds target=_blank to external links -->

  <script type="text/javascript">
    $(document).ready(function () {
      $('a[href^="http://"], a[href^="https://"]').not('a[class*=internal]').attr('target', '_blank');
    });
  </script>


  <!-- OneTrust Cookies Consent Notice start for dimensions.ai -->
   <script type="text/javascript" src="https://cdn.cookielaw.org/consent/3329b668-7887-4dba-9bee-c3853a706e6f/OtAutoBlock.js" ></script>
   <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="3329b668-7887-4dba-9bee-c3853a706e6f" ></script>
   <script type="text/javascript">
   function OptanonWrapper() { }
   </script>
   <!-- OneTrust Cookies Consent Notice end for dimensions.ai -->
  


</body>
</html>